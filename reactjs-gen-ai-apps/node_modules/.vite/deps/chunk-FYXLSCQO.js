import {
  Amplify,
  CognitoAWSCredentialsAndIdentityIdProvider,
  CookieStorage,
  DefaultIdentityIdStore,
  cognitoUserPoolsTokenProvider,
  defaultStorage,
  parseAWSExports
} from "./chunk-KMS3NUUE.js";

// node_modules/@aws-amplify/auth/dist/esm/providers/cognito/credentialsProvider/index.mjs
var cognitoCredentialsProvider = new CognitoAWSCredentialsAndIdentityIdProvider(new DefaultIdentityIdStore(defaultStorage));

// node_modules/aws-amplify/dist/esm/initSingleton.mjs
var DefaultAmplify = {
  /**
   * Configures Amplify with the {@link resourceConfig} and {@link libraryOptions}.
   *
   * @param resourceConfig The {@link ResourcesConfig} object that is typically imported from the
   * `amplifyconfiguration.json` file. It can also be an object literal created inline when calling `Amplify.configure`.
   * @param libraryOptions The {@link LibraryOptions} additional options for the library.
   *
   * @example
   * import config from './amplifyconfiguration.json';
   *
   * Amplify.configure(config);
   */
  configure(resourceConfig, libraryOptions) {
    let resolvedResourceConfig;
    if (Object.keys(resourceConfig).some((key) => key.startsWith("aws_"))) {
      resolvedResourceConfig = parseAWSExports(resourceConfig);
    } else {
      resolvedResourceConfig = resourceConfig;
    }
    if (!resolvedResourceConfig.Auth) {
      return Amplify.configure(resolvedResourceConfig, libraryOptions);
    }
    if (libraryOptions == null ? void 0 : libraryOptions.Auth) {
      return Amplify.configure(resolvedResourceConfig, libraryOptions);
    }
    if (!Amplify.libraryOptions.Auth) {
      cognitoUserPoolsTokenProvider.setAuthConfig(resolvedResourceConfig.Auth);
      cognitoUserPoolsTokenProvider.setKeyValueStorage(
        // TODO: allow configure with a public interface
        (libraryOptions == null ? void 0 : libraryOptions.ssr) ? new CookieStorage({ sameSite: "lax" }) : defaultStorage
      );
      return Amplify.configure(resolvedResourceConfig, {
        ...libraryOptions,
        Auth: {
          tokenProvider: cognitoUserPoolsTokenProvider,
          credentialsProvider: cognitoCredentialsProvider
        }
      });
    }
    if (libraryOptions) {
      if (libraryOptions.ssr !== void 0) {
        cognitoUserPoolsTokenProvider.setKeyValueStorage(
          // TODO: allow configure with a public interface
          libraryOptions.ssr ? new CookieStorage({ sameSite: "lax" }) : defaultStorage
        );
      }
      return Amplify.configure(resolvedResourceConfig, {
        Auth: Amplify.libraryOptions.Auth,
        ...libraryOptions
      });
    }
    Amplify.configure(resolvedResourceConfig);
  },
  /**
   * Returns the {@link ResourcesConfig} object passed in as the `resourceConfig` parameter when calling
   * `Amplify.configure`.
   *
   * @returns An {@link ResourcesConfig} object.
   */
  getConfig() {
    return Amplify.getConfig();
  }
};

export {
  DefaultAmplify
};
//# sourceMappingURL=chunk-FYXLSCQO.js.map
