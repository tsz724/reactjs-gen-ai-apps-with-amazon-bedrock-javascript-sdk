"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.LockFileParserFactory = void 0;
const amplify_error_1 = require("../errors/amplify-error");
const lock_file_types_1 = require("./lock-file-types");
const package_lock_parser_1 = require("./package-lock-parser");
const yarn_lock_parser_1 = require("./yarn-lock-parser");
const yarn2_lock_parser_1 = require("./yarn2-lock-parser");
class LockFileParserFactory {
    static getLockFileParser(packageManager) {
        var _a, _b;
        switch (packageManager.packageManager) {
            case lock_file_types_1.LockfileType.NPM:
                return new package_lock_parser_1.PackageLockParser();
            case lock_file_types_1.LockfileType.YARN: {
                if (((_a = packageManager === null || packageManager === void 0 ? void 0 : packageManager.version) === null || _a === void 0 ? void 0 : _a.major) && ((_b = packageManager === null || packageManager === void 0 ? void 0 : packageManager.version) === null || _b === void 0 ? void 0 : _b.major) >= 2) {
                    return new yarn2_lock_parser_1.Yarn2LockParser();
                }
                else {
                    return new yarn_lock_parser_1.YarnLockParser();
                }
            }
            default:
                throw new amplify_error_1.AmplifyError('UnsupportedLockFileTypeError', {
                    message: 'Unsupported lockfile type ' + `${packageManager.lockFile} provided. Only 'npm' or 'yarn' is currently ` + 'supported.',
                    resolution: 'Install npm6 or yarn1 to compile overrides for this project.',
                });
        }
    }
}
exports.LockFileParserFactory = LockFileParserFactory;
//# sourceMappingURL=parser-factory.js.map